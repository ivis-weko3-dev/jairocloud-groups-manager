---
title: 初期構築マニュアル
description: JAIRO Cloud Groups Managerの初期構築手順についてのマニュアル。
---
## 概要
本書は、JAIRO Cloud Groups Manager（以降、当システム）を新規に導入する際の**初期構築手順**について記述したマニュアルである。

## 前提条件
当システムで管理するリポジトリは以下の条件を満たす必要がある。
- リポジトリは学認フェデレーションに参加し、EntityID を持つこと。
  EntityIDは `https://<FQDN>/shibboleth-sp` の形式である必要がある。

## 事前準備
当システムの初期構築を行う前に、以下の事前準備を完了しておく必要がある。

1. Redis および PostgreSQL と接続可能なコンソール環境を用意する。
2. FQDN 一覧を含むテキストファイルを用意する。
  FQDN を参照してリポジトリを操作する際に使用する。
   - テキストファイルは一行ごとにリポジトリの FQDN を記載すること。
   - 行内がスペース区切りになっている場合は、最初の要素が FQDN として扱われる。   
3. 各リポジトリに対応する SP 証明書と秘密鍵をマウントしたディレクトリを用意する。
  キャッシュ DB の更新時にはここに配置された証明書と秘密鍵が使用される。
   - ディレクトリの構造は以下の通りとする。
    ```
        .
        ├── <FQDN1>
        │   ├──  server.crt  # SP証明書
        │   ├──  server.key  # SP秘密鍵
        │
        ├── <FQDN2>
        │   ├──  server.crt
        │   ├──  server.key
        │
        └──  ...
    ```




## 初期構築手順
初期構築用スクリプトを実行することで、以下の初期構築処理が自律的に行われる。
::note
アクセストークンの発行時には手動での操作が必要となる。
::

::steps{level="4"}
#### データベースの初期化
- データベースの初期化を行う。
- これには、データベースの作成や必要なテーブルの作成が含まれる。

#### アクセストークンの発行
- システムの管理者用アクセストークンを発行する。
- 操作者にはアクセストークン発行のための認証画面のURLが表示される。
- 操作者が認証を完了するまで待機し、認証完了後にアクセストークンが発行される。

#### リポジトリに対応するSPコネクタの一括作成
- FQDN一覧をもとに各リポジトリに対応するSPコネクタを一括で作成する。
- FQDN一覧を含むテキストファイルを読み込み、SPコネクタを作成する。
::

